{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<a href="{{ url_for('add_book') }}">Add New Book</a>
    <div class="bookshelf">
        {% for shelf in shelves %}
            <div class="shelf">
                {% for book in shelf %}
                     <div class="book">
                         <div class="edit-button-container">
                             <a href="{{ url_for('edit_book', book_id=book[4]) }}" class="action-button edit-button">‚úèÔ∏è</a>
                             <a href="#" class="action-button delete-button" onclick="deleteBook({{ book[4] }})">üóëÔ∏è</a>
                            </form>
                         </div>
                        <img src="{{ book[3] }}" alt="{{ book[0] }} cover">
                        <h3>{{ book[0] }}</h3>
                        <p>{{ book[1] }}</p>
                        <p>{{ book[2] }}</p>
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>

    <script>
    function deleteBook(bookId) {
        fetch(`/delete_book/${bookId}`, { method: 'POST' })
            .then(response => {
                if (response.ok) {
                    location.reload(); // Refresh the page after successful delete
                }
            })
            .catch(error => console.error("Error deleting book:", error));
    }
</script>
{% endblock %}